jQuery(function(c){var g={$specialKeys:[18,37,38,39,40,8,20,17,46,35,13,27,36,45,144,33,34,16,9,91],$rechargeplanSel:c("#rechargeplan"),$rechargeplanLbl:c("#recharge_total_pr"),$memberRow:c("#memberrow"),$noMembersInp:c("#members"),$membersRadio:c("input[name=memberDurRadio]:radio"),$perMemberPrice:c("#permemberprice"),$memberTotalPrice:c("#membertotalprice"),$rcLbl:c("#reclbl"),$planCredits:[],$memberPrices:[],$memberTimeSlab:[],$rechargePrices:[],$rechargeCreditPlans:[],$selMemberTotalPrice:0,$selMemberPrice:0,
$selPlanIdx:0,$isUnlimitedPlan:!1,$commonApp:null,init:function(a){this.$specialKeys.push(8);this.$specialKeys.push(16);this.$specialKeys.push(17);this.$specialKeys.push(18);this.$rechargePrices=[999,3499,8599,49999,5E4];this.$rechargeCreditPlans=[1500,6E3,18E3,125E3];this.$selRechargePrice=3499;this.$memberPrices=[9,8];this.$memberTimeSlab=[6,12];this.$memberRow.hide();this.$commonApp=a;this.bindEvents();return this},bindEvents:function(){this.$rechargeplanSel.on("change",this.changeRechargePrice.bind(this));
this.$membersRadio.on("change",this.changeMemberPrice.bind(this));this.$noMembersInp.on("keyup",this.calMemberPrice.bind(this))},getRecCalculatedAmt:function(){return this.$selRechargePrice},getCurrentSelectedPlanCredit:function(){var a=this.$rechargeplanSel.val();return 4==a?-1:this.$rechargeCreditPlans[a]},getSelectedMember:function(){return this.$isUnlimitedPlan?this.$noMembersInp.val():-1},getSelectedDuration:function(){return this.$noMembersInp.val()},getSelectedMemberDuration:function(){return this.$isUnlimitedPlan?
0==c("input[type='radio'][name='memberDurRadio']:checked").val()?6:12:null},changeRechargePrice:function(a){this.$selPlanIdx=this.$rechargeplanSel.val();4==this.$selPlanIdx?(this.$memberRow.show(),this.$selRechargePrice=2700,this.$isUnlimitedPlan=!0,this.$rcLbl.hide()):(this.$memberRow.hide(),this.$selRechargePrice=this.$rechargePrices[this.$selPlanIdx],this.$rechargeplanLbl.text(this.$commonApp.getFormattedNo(this.$selRechargePrice)),this.$rcLbl.show());this.$commonApp.changeTotal()},changeMemberPrice:function(a){a=
c("input[type='radio'][name='memberDurRadio']:checked");if(0<a.length){this.$selMemberPrice=this.$memberPrices[a.val()];var b=this.$noMembersInp.val(),b=parseFloat(b);isNaN(b)&&(b=0);this.$perMemberPrice.text(this.$selMemberPrice.toFixed(2));this.$selRechargePrice=b*this.$selMemberPrice*this.$memberTimeSlab[a.val()];this.$memberTotalPrice.text(this.$commonApp.getFormattedNo(this.$selRechargePrice.toFixed(2)))}this.$commonApp.changeTotal()},calMemberPrice:function(a){a=a.which?a.which:a.keyCode;a=
48<=a&&57>=a||96<=a&&105>=a||-1!=this.$specialKeys.indexOf(a);var b=this.$noMembersInp.val();a?this.changeMemberPrice():this.$noMembersInp.val(b.substring(0,b.length-1));return a}},h={$groupRow:c("#groupRow"),$grpSize:c("#grpsize"),$norGroupLbl:c("#normal-grp"),$groupNoLbl:c("#group_no"),$durationRadio:c("input[name=durationRadio]:radio"),$grpPriceLbl:c("#grp_total_pr"),$groupPrices6Mon:[],$groupPrices12Mon:[],$selGroupPrice:0,$selGrpIdx:0,$commonApp:null,init:function(a){this.$groupPrices6Mon=[1899,
3578,5037,6276,7295,8094,8673,9032,9171,9090];this.$groupPrices12Mon=[3798,7156,10074,12552,14590,16188,17346,18064,18342,18180];this.setGrpCalculatedDefaultAmt();this.$grpSize.slider();this.$commonApp=a;this.bindEvents();return this},getGrpCalculatedAmt:function(){return this.$selGroupPrice},setGrpCalculatedDefaultAmt:function(){this.$selGroupPrice=1899},resetGrpCalculatedDefaultAmt:function(){this.$selGroupPrice=0},bindEvents:function(){this.$durationRadio.on("change",this.changeGroupPrice.bind(this));
this.$grpSize.on("slide",this.changeGroupPrice.bind(this))},changeGroupPrice:function(a){this.$selGrpIdx=this.$grpSize.slider("getValue");this.$groupNoLbl.text(this.$selGrpIdx);a=c("input[type='radio'][name='durationRadio']:checked");0<a.length&&(1==a.val()?this.$selGroupPrice=10<=this.$selGrpIdx?900*this.$selGrpIdx:this.$groupPrices6Mon[this.$selGrpIdx-1]:this.$selGroupPrice=10<=this.$selGrpIdx?1800*this.$selGrpIdx:this.$groupPrices12Mon[this.$selGrpIdx-1]);this.$grpPriceLbl.text(this.$commonApp.getFormattedNo(this.$selGroupPrice));
this.$commonApp.changeTotal()},getSelectedGroup:function(){return this.$grpSize.slider("getValue")},getGroupDuration:function(){return 1==c("input[type='radio'][name='durationRadio']:checked").val()?6:12}},k={$couponValInp:c("#coupon"),$couponErrorLbl:c("#couponErrorLbl"),$applyBtn:c("#applyBtn"),$urlInput:c("#coupon_url"),$commonApp:null,init:function(a){this.$commonApp=a;this.bindEvents();return this},bindEvents:function(){this.$couponValInp.on("dblclick",this.enableCoupon.bind(this));this.$applyBtn.on("click",
this.applyCoupon.bind(this))},enableCoupon:function(){this.$applyBtn.button("reset");this.$couponValInp.removeAttr("readonly");this.$couponValInp.val("");this.$couponErrorLbl.html("");this.$commonApp.changeTotal()},showError:function(a){this.$couponErrorLbl.html(a);this.$couponErrorLbl.removeClass("label-success-c");this.$couponErrorLbl.addClass("label-error")},applyCoupon:function(a){a.preventDefault();this.$applyBtn.button("loading");a=this.$commonApp.getCurrentAmount();if(0>a)this.$couponErrorLbl.text("Total amount should be greater than 0"),
this.$couponErrorLbl.addClass("label-error"),this.$applyBtn.button("reset");else if(""==this.$couponValInp.val()||"undefined"==typeof this.$couponValInp.val())this.$couponValInp.addClass("field-error"),this.$couponErrorLbl.text("Please enter coupon code"),this.$couponErrorLbl.addClass("label-error"),this.$applyBtn.button("reset");else{this.$couponValInp.removeClass("field-error");var b=this;c.ajax({type:"POST",withCredentials:!0,async:!1,url:b.$urlInput.val(),headers:{csrftoken:this.$commonApp.getCSRFToken()},
data:{csrfmiddlewaretoken:this.$commonApp.getCSRFToken(),code:this.$couponValInp.val(),amount:a},success:function(a){"undefined"!=typeof a.error&&""!=a.error?(b.$couponErrorLbl.html(a.error),b.$couponErrorLbl.removeClass("label-success-c"),b.$couponErrorLbl.addClass("label-error"),b.$couponValInp.addClass("field-error")):(b.$couponErrorLbl.html(a.success),b.$couponErrorLbl.removeClass("label-error"),b.$couponErrorLbl.addClass("label-success-c"),b.$couponValInp.removeClass("field-error"),b.$couponValInp.attr("readonly",
"readonly"));b.$commonApp.setNewAmount(a.new_amount);b.$applyBtn.button("reset");return!1},error:function(a,c,f){console.log(a);console.log(c);console.log(f);b.$applyBtn.button("reset")}})}return!1}};({$payBtn:c("#btnpay"),$secureAmt:c("#id_secure_hash"),$amtHidden:c("#id_amount"),$totalPriceBtn:c("#total_prbtn"),$refNoHidden:c("#id_reference_no"),$form:c("#frmTransaction"),$urlInput:c("#hash_url"),$choiceCheckboxes:c("input[name=choiceCheckbox]"),$buyMessagesRadio:c("#buy_messages"),$buyGroupsRadio:c("#buy_groups"),
$option:null,$isGroupEnabled:!0,$isMessageEnabled:!0,$csrf:{$csrfToken:null,init:function(){this.$csrfToken=this.getCookie("csrftoken");c.ajaxSetup({beforeSend:function(a,b){/^http:./.test(b.url)||/^https:./.test(b.url)||a.setRequestHeader("X-CSRFToken",this.$csrfToken)}});return this},getToken:function(){"undefined"==typeof this.$csrfToken&&(this.$csrfToken=this.getCookie("csrftoken"));return this.$csrfToken},setHeader:function(a){a.setRequestHeader("X-CSRFToken",this.$csrfToken)},getCookie:function(a){var b=
null;if(document.cookie&&""!=document.cookie)for(var c=document.cookie.split(";"),d=0;d<c.length;d++){var f=jQuery.trim(c[d]);if(f.substring(0,a.length+1)==a+"="){b=decodeURIComponent(f.substring(a.length+1));break}}return b}}.init(),$couponApp:null,$groupApp:null,$rechargeApp:null,init:function(){this.$couponApp=k.init(this);this.$groupApp=h.init(this);this.$rechargeApp=g.init(this);this.$amtHidden.val(5398);this.$option=3;this.bindEvents()},bindEvents:function(){this.$payBtn.on("click",this.getSecureHash.bind(this));
this.$choiceCheckboxes.on("change",this.changePurchaseChoice.bind(this))},changePurchaseChoice:function(a){var b=c(c(a.target).attr("target"));c(a.target).is(":checked")?b.fadeIn(500):b.fadeOut(500);this.$isGroupEnabled=this.$buyGroupsRadio.is(":checked");this.$isMessageEnabled=this.$buyMessagesRadio.is(":checked");this.$buyMessagesRadio.is(":checked")||this.$buyGroupsRadio.is(":checked")||(this.$buyMessagesRadio.prop("checked",!0),this.$buyMessagesRadio.trigger("change"),this.$isMessageEnabled=!0);
this.changeTotal()},getCurrentAmount:function(){this.changeTotal();return this.$amtHidden.val()},getSecureHash:function(a){a.preventDefault();var b=0,e=0;this.$isGroupEnabled&&this.$isMessageEnabled?(b=this.$rechargeApp.getCurrentSelectedPlanCredit(),e=this.$groupApp.getSelectedGroup(),this.$option=3):this.$isGroupEnabled?(e=this.$groupApp.getSelectedGroup(),this.$option=1):(b=this.$rechargeApp.getCurrentSelectedPlanCredit(),this.$option=2);var d=this;c.ajax({type:"POST",withCredentials:!0,async:!1,
url:d.$urlInput.val(),headers:{csrftoken:this.$csrf.getToken()},data:{csrfmiddlewaretoken:d.$csrf.getToken(),amount:d.$amtHidden.val(),refrenceno:d.$refNoHidden.val(),credits:b,nogroups:e,groupduration:d.$groupApp.getGroupDuration(),nomembers:d.$rechargeApp.getSelectedMember(),memberduration:d.$rechargeApp.getSelectedMemberDuration(),option:d.$option},success:function(b){"undefined"!=typeof b.error&&""!=b.error?(d.$couponApp.showError(b.error),a.stopPropagation()):(d.$secureAmt.val(b.token),d.$form.submit())},
error:function(b,c,e){console.log(b);console.log(c);console.log(e);d.$applyBtn.button("reset");a.stopPropagation();return!1}})},getFormattedNo:function(a){var b=a.toString();a="";0<b.indexOf(".")&&(a=b.substring(b.indexOf("."),b.length));var b=Math.floor(b),b=b.toString(),c=b.substring(b.length-3),b=b.substring(0,b.length-3);""!=b&&(c=","+c);return b.replace(/\B(?=(\d{2})+(?!\d))/g,",")+c+a},changeTotal:function(){var a=0;this.$isMessageEnabled&&(a+=this.$rechargeApp.getRecCalculatedAmt());this.$isGroupEnabled&&
(a+=this.$groupApp.getGrpCalculatedAmt());this.$totalPriceBtn.text(a);this.$amtHidden.val(a.toFixed(2))},setNewAmount:function(a){this.$totalPriceBtn.text(a);this.$amtHidden.val(a)},getCSRFToken:function(){return this.$csrf.getToken()}}).init()});